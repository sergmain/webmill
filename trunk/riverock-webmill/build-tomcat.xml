<?xml version="1.0"?>
<!--
  ~ org.riverock.webmill - Portal framework implementation
  ~
  ~ Copyright (C) 2006, Riverock Software, All Rights Reserved.
  ~
  ~ Riverock - The Open-source Java Development Community
  ~ http://www.riverock.org
  ~
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<project name="Webmill portal, tomcat extension" default="usage-main" basedir=".">
    <import file="build.xml"/>

    <property name="url"      value="http://me.askmore/manager"/>
    <property name="username" value="admin"/>
    <property name="password" value=""/>

    <path id="deployer.classpath">
        <fileset dir="${tomcat-home}/server/lib">
            <include name="*.jar"/>
        </fileset>
        <fileset dir="${tomcat-home}/server/lib">
            <include name="*.jar"/>
        </fileset>
    </path>

    <taskdef resource="org/apache/catalina/ant/catalina.tasks">
        <classpath>
            <path refid="deployer.classpath"/>
        </classpath>
    </taskdef>

    <target name="undeploy" description="Undeploy web application">
        <undeploy url="${url}" username="${username}" password="${password}" path="/${portlet-context-name}"/>
    </target>

    <target name="stop" description="Undeploy web application">
        <stop url="${url}" username="${username}" password="${password}" path="/${portlet-context-name}"/>
    </target>

    <target name="start" description="Undeploy web application">
        <start url="${url}" username="${username}" password="${password}" path="/${portlet-context-name}"/>
    </target>

    <target name="reload_with_new_jar">
        <antcall target="stop"/>
        <antcall target="jar"/>
        <copy file="${build.dir}\${main.lib}" todir="C:\opt2\_www\_me.askmore.info\ROOT\WEB-INF\lib" overwrite="true"/>
        <antcall target="start"/>
    </target>

</project>
