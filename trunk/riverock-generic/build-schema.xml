<?xml version="1.0" encoding="utf-8"?>

<!--

/*

 * org.riverock.generic - Database connectivity classes

 * 

 * Copyright (C) 2004, Riverock Software, All Rights Reserved.

 * 

 * Riverock - The Open-source Java Development Community

 * http://www.riverock.org

 * 

 * 

 * This library is free software; you can redistribute it and/or

 * modify it under the terms of the GNU Lesser General Public

 * License as published by the Free Software Foundation; either

 * version 2.1 of the License, or (at your option) any later version.

 *

 * This library is distributed in the hope that it will be useful,

 * but WITHOUT ANY WARRANTY; without even the implied warranty of

 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU

 * Lesser General Public License for more details.

 *

 * You should have received a copy of the GNU Lesser General Public

 * License along with this library; if not, write to the Free Software

 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA

 *

 */

-->

<!--$Id$-->

<project name="Webmill schema generic" default="gen_all_schema" basedir=".">



    <property name="java.target" value="1.4"/>

    <property name="java.class.target" value="1.4"/>





    <property name="Name" value="riverock-generic"/>



    <property name="lib.dir" value="../js-lib/lib"/>

    <property name="local-lib.dir" value="lib"/>



    <!-- riverock runtime library -->

    <property name="jsmithy-common.lib" value="jsmithy-common-1.2.0.jar"/>

    <property name="jsmithy-cache.lib" value="jsmithy-cache-1.0.0.jar"/>

    <property name="jsmithy-sql-parser.lib" value="jsmithy-sql-parser-1.1.6.jar"/>





    <property name="portlet.lib" value="portlet-1.0.jar"/>

    <property name="secure.lib" value="bcprov-jdk14-122.jar"/>



    <property name="castor.lib" value="castor-0.9.5.1.1-xml.jar"/>

<!--    <property name="castor.lib" value="castor-0.9.4.3-xml.jar"/>-->



    <property name="xerces.lib" value="xercesImpl-2.6.0.jar"/>

    <property name="xml-api.lib" value="xmlParserAPIs-2.6.0.jar"/>



    <property name="junit.lib" value="junit.jar"/>

    <property name="log4j.lib" value="log4j-1.2.7.jar"/>



    <property name="exclude" value="**/*.txt, **/*.bat, **/*.xml, **/*.sh, **/*.jav, **/*.mf, **/*.class,**/tmp_*.java"/>



    <property name="doc.dir" value="doc"/>

    <property name="src.dir" value="src-schema"/>

    <property name="tomcat.dir" value="tomcat"/>



    <property name="src.tomcat-xml.dir" value="${src.dir}/tomcat-xml"/>



    <property name="src.java.dir" value="${src.dir}/java"/>

    <property name="src.java-test.dir" value="${src.dir}/test"/>



    <property name="src.jsp.dir" value="${src.dir}/jsp"/>

    <property name="src.xsd.dir" value="${src.dir}/xsd"/>

    <property name="src.xml.dir" value="${src.dir}/xml"/>



    <path id="classpath-1.4">

        <pathelement location="${lib.dir}/1.4/ojdbc14.jar"/>

    </path>



    <path id="classpath-1.3">

        <pathelement location="${lib.dir}/1.3/classes12.zip"/>

        <pathelement location="${lib.dir}/xml-commons-1.1.1.jar"/>

        <pathelement location="${lib.dir}/jce1_2_1.jar"/>

    </path>

    <path id="classpath-base">

        <pathelement location="${lib.dir}/${log4j.lib}"/>

        <pathelement location="${lib.dir}/${castor.lib}"/>

        <pathelement location="${lib.dir}/${xerces.lib}"/>

        <pathelement location="${lib.dir}/${xml-api.lib}"/>



<!--        <path refid="classpath-${java.target}"/>-->

    </path>



    <property name="packages" value="org.riverock.*"/>

    <property name="build.dir" value="build-schema"/>

    <property name="build.dest" value="${build.dir}/classes"/>

    <property name="build.java" value="${build.dir}/java"/>

    <property name="build.tests" value="${build.dir}/tests"/>

    <property name="build.src.java" value="${src.java.dir}"/>

    <property name="build.src.jsp" value="${src.jsp.dir}"/>



    <property name="dist.dir" value="${build.dir}/dist"/>

    <property name="docs.dir" value="${build.dir}/javadocs"/>





    <property name="debug" value="on"/>

    <property name="optimize" value="off"/>

    <property name="deprecation" value="on"/>



    <target name="clean">

        <delete failonerror="false">

            <fileset dir="${build.dir}">

                <include name="**"/>

                <include name="*.jar"/>

                <include name="*.tar"/>

                <include name="*.gz"/>

            </fileset>

        </delete>

        <delete dir="${docs.dir}" failonerror="false"/>

        <delete dir="${build.dir}/src/" failonerror="false"/>

        <delete dir="${build.dir}/classes/" failonerror="false"/>

        <delete dir="${build.dir}/bin/" failonerror="false"/>

        <delete dir="${build.dir}/tomcat/" failonerror="false"/>

        <delete dir="${build.dir}/ext/" failonerror="false"/>

        <delete dir="${build.dir}" failonerror="false"/>



    </target>



    <target name="delete_all_schema">

        <delete includeEmptyDirs="false" failonerror="false">

            <fileset dir="${src.java.dir}/org/riverock/generic/schema">

                <include name="**/*.java"/>

                <exclude name="**/CVS/**"/>

            </fileset>

        </delete>

    </target>



    <target name="gen_all_schema">

        <antcall target="delete_all_schema"/>

        <antcall target="gen_all_db_schema"/>

        <antcall target="gen_config_schema"/>

        <antcall target="gen_transfer_file_schema"/>



<!--        <antcall target="gen_site_schema"/>-->

<!--        <antcall target="gen_tomcat_schema"/>-->

<!--        <antcall target="gen_castor_schema"/>-->

<!--        <antcall target="gen_core-extend_schema"/>-->

<!--        <antcall target="gen_java_auth_schema"/>-->

<!--        <antcall target="gen_test_schema"/>-->

<!--        <antcall target="gen_test_import_schema"/>-->

<!--        <antcall target="gen_test_import_core_schema"/>-->

    </target>

    <target name="gen_all_db_schema">

        <antcall target="gen_db_schema"/>

        <antcall target="gen_db_structure_schema"/>

    </target>

    <target name="gen_config_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/generic/schema/config/"/>

        <property name="schema-file" value="${src.dir}/xsd/riverock-generic-config.xsd"/>

        <property name="schema-package-java" value="org.riverock.generic.schema.config"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_transfer_file_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/generic/schema/transfer/"/>

        <property name="schema-file" value="${src.dir}\xsd\mill-transfer-file.xsd"/>

        <property name="schema-package-java" value="org.riverock.generic.schema.transfer"/>

        <antcall target="gen_schema"/>

    </target>



    <target name="gen_site_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema\site\"/>

        <property name="schema-file" value="${src.dir}\xsd\mill-site.xsd"/>

        <property name="schema-package-java" value="org.riverock.schema.site"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_tomcat_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema\tomcat\"/>

        <property name="schema-file" value="${src.dir}\xsd\mill-tomcat.xsd"/>

        <property name="schema-package-java" value="org.riverock.schema.tomcat4"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_castor_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema\castor\"/>

        <property name="schema-file" value="${src.dir}\xsd\mill-castor-mapping.xsd"/>

        <property name="schema-package-java" value="org.riverock.schema.castor"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_appl-server_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema/appl_server/"/>

        <property name="schema-file" value="${src.dir}/xsd/mill-appl-server.xsd"/>

        <property name="schema-package-java" value="org.riverock.schema.appl_server"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_core-extend_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema/extend/"/>

        <property name="schema-file" value="${src.dir}/xsd/mill-core-extend.xsd"/>

        <property name="schema-package-java" value="org.riverock.schema.extend"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_java_auth_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema\a3\"/>

        <property name="schema-file" value="${src.dir}\xsd\mill-auth.xsd"/>

        <property name="schema-package-java" value="org.riverock.schema.a3"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_test_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema\test\"/>

        <property name="schema-file" value="${src.dir}\xsd\test\mill-test-schema.xsd"/>

        <property name="schema-package-java" value="org.riverock.schema.test"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_test_with_2_sequnce" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema\test\test_2_sequence"/>

        <property name="schema-file" value="${src.dir}\xsd\test\test_with_2_sequnce.xsd"/>

        <property name="schema-package-java" value="org.riverock.schema.test.test_2_sequence"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_test_import_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema\testimport\"/>

        <property name="schema-file" value="${src.dir}\xsd\test\prr_complex_only.xsd "/>

        <property name="schema-package-java" value="org.riverock.schema.testimport"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_test_import_core_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/schema\testimport\core"/>

        <property name="schema-file" value="${src.dir}\xsd\test\prr-core.xsd "/>

        <property name="schema-package-java" value="org.riverock.schema.testimport.core"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_db_structure_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/generic/schema/db/structure"/>

        <property name="schema-file" value="${src.dir}\xsd\mill-database-structure.xsd"/>

        <property name="schema-package-java" value="org.riverock.generic.schema.db.structure"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_db_schema" depends="prepare">

        <property name="schema-dir" value="${src.java.dir}/org/riverock/generic/schema/db"/>

        <property name="schema-file" value="${src.dir}\xsd\mill-database.xsd"/>

        <property name="schema-package-java" value="org.riverock.generic.schema.db"/>

        <antcall target="gen_schema"/>

    </target>

    <target name="gen_schema">

        <antcall target="clean"/>

        <delete includeEmptyDirs="false" failonerror="false">

            <fileset dir="${schema-dir}">

                <include name="*.java"/>

                <exclude name="**/CVS/**"/>

            </fileset>

        </delete>

        <echo message="XSD - ${schema-file}"/>

        <java fork="true" classname="org.exolab.castor.builder.SourceGenerator">

            <arg value="-i"/>

            <arg value="${schema-file}"/>

            <arg value="-package"/>

            <arg value="${schema-package-java}"/>

            <arg value="-dest"/>

            <arg value="${src.java.dir}"/>

            <arg value="-types"/>

            <arg value="j2"/>

            <arg value="-f"/>

            <arg value="-binding-file"/>

            <arg value="${src.xml.dir}/binding.xml"/>

            <classpath>

                <pathelement location="${local-lib.dir}/castor" />

                <path refid="classpath-base"/>

            </classpath>

        </java>

    </target>



<!--    <target name="del_core_files" depends="init">-->

<!--        <delete includeEmptyDirs="false" failonerror="false">-->

<!--            <fileset dir="${src.java.dir}/mill/main/core">-->

<!--                <include name="*.java"/>-->

<!--                <exclude name="**/CVS/**"/>-->

<!--            </fileset>-->

<!--        </delete>-->

<!--    </target>-->



    <target name="compile_all_schema">

        <antcall target="compile"/>

    </target>

    <!-- Initialization target                                               -->

    <target name="init">



        <!-- developer.lib.dir is the developer snapshot directory.           -->

        <!-- If it is not set, it defaults to build.dir, and "build install"  -->

        <!-- will not do anything.                                            -->

<!--        <property name="developer.lib.dir" value="${build.dir}"/>-->

        <!-- developer.bin.dir is the developer snapshot directory.           -->

        <!-- If it is not set, it defaults to argo.bin.dir, and               -->

        <!-- "build install"  will not do anything.                           -->

        <!--

        <available classname="javax.servlet.Servlet" classpath="${classpath}" property="has.servlet"/>

        -->

<!--        <property name="javadoc.use" value="true"/>-->

        <!-- General javadocs probably should not show private -->

<!--        <property name="javadoc.private" value="false"/>-->

<!--        <property name="javadoc.splitindex" value="true"/>-->

<!--        <property name="javadoc.author" value="false"/>-->

<!--        <property name="xerces.javadoc.link" value="http://xml.apache.org/xerces-j/apiDocs"/>-->

<!--        <property name="log4j.javadoc.link" value="e:\opt2\jakarta-log4j-1.2.6/docs/api"/>-->

<!--        <property name="jdk.javadoc.link" value="http://java.sun.com/products/jdk/1.2/docs/api"/>-->

    </target>

    <!-- Note this file can only make Ant display values set in the file correctly, -->

    <!-- but external values in the environment or properties file will be operational.  -->

    <!-- Help on usage                                                       -->

    <target name="usage" depends="init">

        <echo message=""/>

        <echo message=""/>

        <echo message="${Name} Build file"/>

        <echo message="-------------------------------------------------------------"/>

        <echo message=""/>

        <echo message=" available targets are:"/>

        <echo message=""/>

        <echo message="   compile      --> compiles the source code to the tree under ${build.dir}"/>

        <echo message="   package      --> generates the ${Name}.jar file"/>

        <echo message="   prepare-docs --> writes the documentation to ${docs.dir}"/>

        <echo message="   clean        --> cleans up the ${build.dir} directory"/>

        <echo message="   distclean    --> cleans up the distribution directory, ${dist.dir}"/>

        <echo message="   usage        --> show this message (default)"/>

        <echo message=""/>

        <echo message=" See the comments inside the build.xml file for more details."/>

        <echo message="-------------------------------------------------------------"/>

        <echo message=""/>

        <echo message=""/>

    </target>

    <!-- Prepares the build directory                                        -->

    <target name="prepare">

        <mkdir dir="${build.dir}"/>

        <mkdir dir="${build.dest}"/>

        <mkdir dir="${build.tests}"/>

    </target>

    <!-- Checks for necessary libraries and correct versions of libraries    -->

    <!--

    <target name="check.servlet" depends="prepare" unless="has.servlet">

        <fail message="servlet library does not appear to be in the classpath."/>

    </target>

    -->

    <!-- Compiles the source directory                                       -->

    <!-- <target name="compile" depends="prepare"> -->



</project>

